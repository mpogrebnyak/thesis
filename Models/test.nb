(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     37989,        839]
NotebookOptionsPosition[     37582,        823]
NotebookOutlinePosition[     37926,        838]
CellTagsIndexPosition[     37883,        835]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"speed", " ", "=", 
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "e", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dx0", "=", "60"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"x0", " ", "=", " ", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\[Tau]", " ", "=", " ", "1"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tt", "=", "100"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"dStart", " ", "=", " ", "0.5"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\[Lambda]Start", " ", "=", " ", "5"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tmax", " ", "=", "150"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"q", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"qq", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"T", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"b", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"s", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["v", "max"], "=", "40"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "solF", ",", " ", "solS", ",", " ", "solT", ",", " ", "u",
                     ",", "  ", "v", ",", "  ", "w", ",", " ", "t"}], "}"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"solF", " ", "=", " ", 
                    RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"u", "''"}], "[", "t", "]"}], "\[Equal]", " ", 
                    RowBox[{"a", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"u", "'"}], "[", "t", "]"}], "/", 
                    SubscriptBox["v", "max"]}], ")"}], "^", "s"}]}], 
                    ")"}]}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"t", " ", "/;", " ", 
                    RowBox[{"t", "\[LessEqual]", " ", "0"}]}], "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"-", "0"}], "*", "\[Lambda]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"u", "'"}], "[", 
                    RowBox[{"t", " ", "/;", " ", 
                    RowBox[{"t", "\[LessEqual]", " ", "0"}]}], "]"}], " ", 
                    "\[Equal]", " ", "0"}]}], "}"}], ",", "u", ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", " ", ",", "tmax"}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"solS", " ", "=", " ", 
                    RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "''"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "'"}], "[", "t", "]"}], "/", 
                    SubscriptBox["v", "max"]}], ")"}], "^", "s"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"a", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "+", 
                    RowBox[{"qq", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "'"}], "[", "t", "]"}], "/", 
                    SubscriptBox["v", "max"]}], " ", "]"}]}], "+", 
                    RowBox[{"T", "*", 
                    RowBox[{
                    RowBox[{"v", "'"}], "[", "t", "]"}]}], " ", "+", "  ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "'"}], "[", "t", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "'"}], "[", "t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"u", "'"}], "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solF"}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solF"}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"v", "[", "t", "]"}]}], ")"}]}], ")"}], "^", 
                    "2"}]}]}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"t", " ", "/;", " ", 
                    RowBox[{"t", "\[LessEqual]", " ", "\[Tau]"}]}], " ", 
                    "]"}], " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "*", "\[Lambda]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "'"}], "[", 
                    RowBox[{"t", " ", "/;", " ", 
                    RowBox[{"t", "\[LessEqual]", " ", "\[Tau]"}]}], " ", 
                    "]"}], " ", "\[Equal]", " ", "0"}]}], "}"}], ",", "v", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]", ",", "tmax"}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"solT", " ", "=", " ", 
                    RowBox[{"NDSolve", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "''"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "'"}], "[", "t", "]"}], "/", 
                    SubscriptBox["v", "max"]}], " ", ")"}], "^", "s"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"a", 
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"q", "+", 
                    RowBox[{"qq", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "'"}], "[", "t", "]"}], "/", 
                    SubscriptBox["v", "max"]}], " ", "]"}]}], "+", 
                    RowBox[{"T", "*", 
                    RowBox[{
                    RowBox[{"w", "'"}], "[", "t", "]"}]}], " ", "+", "  ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "'"}], "[", "t", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "'"}], "[", "t", "]"}], "-", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "'"}], "t"}], "-", "\[Tau]"}], "]"}]}], " ", 
                    "/.", "solS"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}]}]}], ")"}], ")"}], 
                "/", 
                RowBox[{"(", 
                 RowBox[{"2", "*", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"v", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solS"}], 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"w", "[", "t", "]"}]}], ")"}]}], ")"}], "^", "2"}], 
           ",", " ", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"t", " ", "/;", " ", 
              RowBox[{"t", "\[LessEqual]", " ", 
               RowBox[{"2", "*", "\[Tau]"}]}]}], " ", "]"}], " ", "\[Equal]", 
            " ", 
            RowBox[{
             RowBox[{"-", "2"}], "*", "\[Lambda]"}]}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"w", "'"}], "[", 
             RowBox[{"t", " ", "/;", " ", 
              RowBox[{"t", "\[LessEqual]", " ", 
               RowBox[{"2", "*", "\[Tau]"}]}]}], " ", "]"}], " ", "\[Equal]", 
            " ", "0"}]}], "}"}], ",", "w", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"2", "*", "\[Tau]"}], ",", "tmax"}], "}"}]}], "]"}], ";"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"solT", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"w", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{"d", "*", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solS"}], 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"w", "[", "t", "]"}], "-", "\[Lambda]"}], ")"}]}]}], 
             ",", " ", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"t", " ", "/;", " ", 
                RowBox[{"t", "\[LessEqual]", " ", 
                 RowBox[{"2", "*", "\[Tau]"}]}]}], " ", "]"}], " ", 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"-", "2"}], "*", "\[Lambda]"}]}]}], "}"}], ",", "w", 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"2", "*", "\[Tau]"}], "  ", ",", "tmax"}], "}"}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sol4", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{"d", "*", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solT"}], 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"p", "[", "t", "]"}], "-", "\[Lambda]"}], ")"}]}]}], 
             ",", " ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"t", " ", "/;", " ", 
                RowBox[{"t", "\[LessEqual]", " ", 
                 RowBox[{"3", "*", "\[Tau]"}]}]}], " ", "]"}], " ", 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"-", "3"}], "*", "\[Lambda]"}]}]}], "}"}], ",", "p", 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"3", "*", "\[Tau]"}], "  ", ",", "tmax"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sol5", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"g", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{"d", "*", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "sol4"}], 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"g", "[", "t", "]"}], "-", "\[Lambda]"}], ")"}]}]}], 
             ",", " ", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"t", " ", "/;", " ", 
                RowBox[{"t", "\[LessEqual]", " ", 
                 RowBox[{"4", "*", "\[Tau]"}]}]}], " ", "]"}], " ", 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"-", "4"}], "*", "\[Lambda]"}]}]}], "}"}], ",", "g", 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"4", "*", "\[Tau]"}], "  ", ",", "tmax"}], "}"}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"t", "-", 
               RowBox[{"2", "*", "\[Tau]"}]}], ",", 
              RowBox[{
               RowBox[{"u", "'"}], "[", 
               RowBox[{"t", "-", 
                RowBox[{"2", "*", "\[Tau]"}]}], "]"}]}], "}"}], " ", "/.", 
            " ", "solF"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"t", "-", 
               RowBox[{"1", "*", "\[Tau]"}]}], ",", 
              RowBox[{
               RowBox[{"v", "'"}], "[", 
               RowBox[{"t", "-", 
                RowBox[{"1", "*", "\[Tau]"}]}], "]"}]}], "}"}], " ", "/.", 
            " ", "solS"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"t", "-", 
               RowBox[{"0", "*", "\[Tau]"}]}], ",", 
              RowBox[{
               RowBox[{"w", "'"}], "[", 
               RowBox[{"t", "-", 
                RowBox[{"0", "*", "\[Tau]"}]}], "]"}]}], "}"}], " ", "/.", 
            " ", "solT"}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"t", "-", 
                RowBox[{"0", "*", "\[Tau]"}]}], ",", 
               RowBox[{
                RowBox[{"w", "'"}], "[", 
                RowBox[{"t", "-", 
                 RowBox[{"0", "*", "\[Tau]"}]}], "]"}]}], "}"}], " ", "/.", 
             " ", "solT"}], "]"}], ","}], "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"t", "-", "\[Tau]"}], ",", 
               RowBox[{
                RowBox[{"p", "'"}], "[", 
                RowBox[{"t", "-", "\[Tau]"}], "]"}]}], "}"}], " ", "/.", " ", 
             "sol4"}], "]"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{
                RowBox[{"g", "'"}], "[", "t", "]"}]}], "}"}], " ", "/.", " ", 
             "sol5"}], "]"}]}], "*)"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"(*", "4", "*)"}], 
          RowBox[{"2", "*", "\[Tau]"}], ",", "tmax"}], "}"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "tmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"dx0", "+", "15"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\:0413\:0440\:0430\:0444\:0438\:043a \:0441\:043a\:043e\:0440\
\:043e\:0441\:0442\:0438\>\""}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\:0432\:0440\:0435\:043c\:044f", ",", 
           "\:0441\:043a\:043e\:0440\:043e\:0441\:0442\:044c"}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\:043c\:0430\:0448\:0438\:043d\:0430 \:21161\>\"", ",", 
           "\"\<\:043c\:0430\:0448\:0438\:043d\:0430 \:21162\>\"", ",", 
           "\"\<\:043c\:0430\:0448\:0438\:043d\:0430 \:21163\>\"", ",", 
           "\"\<\:043c\:0430\:0448\:0438\:043d\:0430 \:21164\>\"", ",", 
           "\"\<\:043c\:0430\:0448\:0438\:043d\:0430 \:21165\>\""}], 
          "}"}]}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]", ",", "\[Lambda]Start"}], "}"}], ",", "1", ",", 
      "10", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "1"}], "}"}], ",", "1", ",", "10", ",", "1"}], "}"}],
     ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qq", ",", "1"}], "}"}], ",", "1", ",", "10", ",", "1"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "1"}], "}"}], ",", "1", ",", "10", ",", "1"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "1"}], "}"}], ",", "1", ",", "10", ",", "1"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "1"}], "}"}], ",", "1", ",", "10", ",", "1"}], 
     "}"}]}], "\[IndentingNewLine]"}], 
  RowBox[{"(*", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "solF", ",", " ", "solS", ",", " ", "solT", ",", " ", "u", ",", "  ", 
         "v", ",", "  ", "w", ",", " ", "t"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"solF", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"u", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"d", "*", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{"qqq", "[", "t", "]"}], "]"}], " ", "-", 
                  RowBox[{"u", "[", "t", "]"}]}], ")"}]}], "-", 
               RowBox[{"d", "*", "\[Lambda]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"t", " ", "/;", " ", 
                RowBox[{"t", "\[LessEqual]", " ", "0"}]}], "]"}], " ", 
              "\[Equal]", " ", 
              RowBox[{"-", "\[Lambda]"}]}]}], "}"}], ",", "u", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", " ", ",", "tmax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"solS", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"v", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"d", "*", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solF"}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"v", "[", "t", "]"}]}], ")"}]}], "-", 
               RowBox[{"d", "*", "\[Lambda]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"t", " ", "/;", " ", 
                RowBox[{"t", "\[LessEqual]", " ", "\[Tau]"}]}], " ", "]"}], 
              " ", "\[Equal]", " ", 
              RowBox[{
               RowBox[{"-", "2"}], "*", "\[Lambda]"}]}]}], "}"}], ",", "v", 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]", ",", "tmax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"solT", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"w", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{"d", "*", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}], " ", "/.", "solS"}], 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"w", "[", "t", "]"}], "-", "\[Lambda]"}], ")"}]}]}], 
             ",", " ", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"t", " ", "/;", " ", 
                RowBox[{"t", "\[LessEqual]", " ", 
                 RowBox[{"2", "*", "\[Tau]"}]}]}], " ", "]"}], " ", 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"-", "3"}], "*", "\[Lambda]"}]}]}], "}"}], ",", "w", 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"2", "*", "\[Tau]"}], "  ", ",", "tmax"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ParametricPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"t", "-", 
                  RowBox[{"2", "*", "\[Tau]"}]}], "]"}], ",", 
                RowBox[{"t", "-", 
                 RowBox[{"2", "*", "\[Tau]"}]}]}], "}"}], " ", "/.", " ", 
              "solF"}], "]"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}], ",", 
                RowBox[{"t", "-", "\[Tau]"}]}], "}"}], " ", "/.", " ", 
              "solS"}], "]"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"w", "[", "t", "]"}], ",", "t"}], "}"}], " ", "/.", 
              " ", "solT"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"2", "*", "\[Tau]"}], ",", "tmax"}], "}"}], ",", " ", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "50"}], ",", "50"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "40"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Distance\>\""}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"distance", ",", "time"}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<first car\>\"", ",", "\"\<second car\>\"", ",", 
             "\"\<third car\>\""}], "}"}]}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "\[Lambda]Start"}], "}"}], ",", "0", ",", 
       "30", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", "dStart"}], "}"}], ",", "0", ",", "2", ",", 
       "0.01"}], "}"}]}], "]"}], "*)"}], "]"}]], "Input",
 CellChangeTimes->{{3.76003417224006*^9, 3.760034173770011*^9}, {
   3.760034229763503*^9, 3.7600342308444977`*^9}, {3.7601944865794673`*^9, 
   3.7601946052996783`*^9}, {3.7601947291050787`*^9, 
   3.7601948519706964`*^9}, {3.76019488381722*^9, 3.7601949181340933`*^9}, {
   3.7601949712039633`*^9, 3.760194971627576*^9}, {3.76019509172324*^9, 
   3.760195094996182*^9}, {3.7601951388375564`*^9, 3.760195204011911*^9}, {
   3.760195251026614*^9, 3.760195255895797*^9}, {3.760195353151193*^9, 
   3.7601954110759377`*^9}, {3.760195460532059*^9, 3.7601954974701753`*^9}, {
   3.7601956900143347`*^9, 3.760195701436454*^9}, {3.760195736496995*^9, 
   3.7601957368504877`*^9}, {3.760195947779661*^9, 3.7601960569163413`*^9}, {
   3.760196095393794*^9, 3.7601961318997555`*^9}, {3.7601961931168194`*^9, 
   3.760196204634485*^9}, {3.7601963007383986`*^9, 3.7601963293414516`*^9}, {
   3.76019637308258*^9, 3.7601963953684244`*^9}, {3.7601965096842394`*^9, 
   3.7601965287939076`*^9}, 3.7601967905957146`*^9, {3.760196833279434*^9, 
   3.760196876680813*^9}, {3.7601971816049566`*^9, 3.7601972566374874`*^9}, {
   3.7601974346166945`*^9, 3.760197435987376*^9}, {3.761385629141265*^9, 
   3.7613856874966717`*^9}, {3.761385740472963*^9, 3.7613857538519845`*^9}, {
   3.761386876180581*^9, 3.7613869286616406`*^9}, {3.7613869593119307`*^9, 
   3.7613870574044*^9}, {3.761387137675423*^9, 3.7613871380659547`*^9}, {
   3.7613871858745937`*^9, 3.7613872113154325`*^9}, {3.7613875891648035`*^9, 
   3.761387590352022*^9}, {3.7614874266418304`*^9, 3.7614874496798553`*^9}, {
   3.7616595025686536`*^9, 3.7616595281841335`*^9}, {3.761659815458334*^9, 
   3.7616598231866274`*^9}, {3.761659860320397*^9, 3.7616598876113997`*^9}, {
   3.7616599649328527`*^9, 3.761659970513888*^9}, {3.761660058748006*^9, 
   3.761660060184166*^9}, {3.7616601279579835`*^9, 3.7616601281664658`*^9}, {
   3.761660164587058*^9, 3.7616602393342323`*^9}, {3.761660407852426*^9, 
   3.7616604183303747`*^9}, {3.761660543374273*^9, 3.761660553306675*^9}, {
   3.7616605963525968`*^9, 3.7616607243544464`*^9}, 3.761660769856802*^9, {
   3.7616608058106403`*^9, 3.761660813844163*^9}, {3.761660894149519*^9, 
   3.7616609417083764`*^9}, {3.7616611593343616`*^9, 
   3.7616611852401485`*^9}, {3.7616612190018883`*^9, 
   3.7616612627419596`*^9}, {3.7616613077097435`*^9, 
   3.7616613904514976`*^9}, {3.7616614313541927`*^9, 
   3.7616614690713186`*^9}, {3.761661508989648*^9, 3.761661634635703*^9}, {
   3.76166169484275*^9, 3.761661904299676*^9}, {3.761661966696868*^9, 
   3.7616621068255663`*^9}, {3.7616621416913147`*^9, 
   3.7616621815627213`*^9}, {3.7616622307492294`*^9, 3.761662232303076*^9}, {
   3.7616622667629957`*^9, 3.7616622758935795`*^9}, {3.7616623330018716`*^9, 
   3.7616623915922375`*^9}, {3.761662450964513*^9, 3.761662512394332*^9}, {
   3.761662571220067*^9, 3.7616625844606705`*^9}, {3.7616626191588693`*^9, 
   3.761662657142322*^9}, {3.7616626879121075`*^9, 3.761662771392935*^9}, {
   3.7616629418781195`*^9, 3.7616630502085047`*^9}, {3.761663083394825*^9, 
   3.7616633000994067`*^9}, {3.761663424656852*^9, 3.7616634815946355`*^9}, {
   3.7616635151928153`*^9, 3.761663530984596*^9}, {3.761663579659471*^9, 
   3.761663611617035*^9}, {3.761663678012539*^9, 3.761663730729604*^9}, {
   3.761663806437253*^9, 3.7616638193776145`*^9}, {3.7616638524871016`*^9, 
   3.761663892606886*^9}, {3.7616639325251303`*^9, 3.761663970892559*^9}, {
   3.7616640487135963`*^9, 3.761664051974799*^9}, {3.761664141450596*^9, 
   3.761664217748624*^9}, 3.7616643916869555`*^9, {3.761664428131522*^9, 
   3.761664443696911*^9}, {3.7616644819835596`*^9, 3.7616644891763306`*^9}, {
   3.7616646044364786`*^9, 3.761664616667819*^9}, {3.761664648473796*^9, 
   3.7616646691604457`*^9}, {3.7616647650481024`*^9, 
   3.7616648011256557`*^9}, {3.761666366949047*^9, 3.7616663674826183`*^9}, {
   3.7616664714337196`*^9, 3.761666507090431*^9}, {3.761666590188245*^9, 
   3.7616665990226264`*^9}, {3.7616666316434216`*^9, 
   3.7616666516638975`*^9}, {3.7616667491732197`*^9, 
   3.7616667548560276`*^9}, {3.761666854338079*^9, 3.761666861212694*^9}, {
   3.761666937900143*^9, 3.7616669936022267`*^9}, {3.7616670956849833`*^9, 
   3.761667096871804*^9}, {3.7616671631396103`*^9, 3.7616672726791906`*^9}, {
   3.761667402307228*^9, 3.761667554358739*^9}, {3.7616676241575656`*^9, 
   3.76166766868449*^9}, 3.7616711357022886`*^9, 3.761986541147775*^9, 
   3.761986572504634*^9, {3.7626183914402423`*^9, 3.762618420422605*^9}, {
   3.7626184880239244`*^9, 3.7626185378206563`*^9}, {3.7626186109938717`*^9, 
   3.7626186130561132`*^9}, {3.7626190023340836`*^9, 
   3.7626190032650547`*^9}, {3.762619094383876*^9, 3.7626193189724917`*^9}, {
   3.7626193572704477`*^9, 3.7626193846544666`*^9}, {3.7626194252800875`*^9, 
   3.7626194301271753`*^9}, {3.7626194611517873`*^9, 
   3.7626195560497146`*^9}, {3.762619599719284*^9, 3.762619657336665*^9}, {
   3.7626196970365314`*^9, 3.7626197084665365`*^9}, {3.7626197432046747`*^9, 
   3.7626197559927797`*^9}, {3.762622766828188*^9, 3.762623089188152*^9}, {
   3.7626235457932568`*^9, 3.762623639422988*^9}, {3.762623864862527*^9, 
   3.7626239212297726`*^9}, {3.76262401310502*^9, 3.7626240514013586`*^9}, {
   3.7626241150903835`*^9, 3.7626241311485915`*^9}, {3.7626241834322286`*^9, 
   3.762624332231495*^9}, {3.762624377030388*^9, 3.762624377217842*^9}, {
   3.762624407401586*^9, 3.7626244167826557`*^9}, {3.7626244635116253`*^9, 
   3.762624501875029*^9}, {3.762624630844418*^9, 3.7626246994354773`*^9}, {
   3.7626247637972507`*^9, 3.7626248041239605`*^9}, {3.7626248869168477`*^9, 
   3.7626249016512556`*^9}, {3.7626249429791956`*^9, 3.762624951572812*^9}, {
   3.762881201334165*^9, 3.7628812472489786`*^9}, {3.7628814284666986`*^9, 
   3.7628815680500493`*^9}, {3.7628816064171295`*^9, 3.762881647014212*^9}, {
   3.762881686047804*^9, 3.762881744840703*^9}, {3.7628818203620615`*^9, 
   3.7628818207290583`*^9}, {3.7628820248594093`*^9, 
   3.7628820938736115`*^9}, {3.7628821430769596`*^9, 3.762882203869082*^9}, {
   3.762882247990081*^9, 3.7628823167688203`*^9}, 3.762882374935382*^9, {
   3.762882569546842*^9, 3.762882599534991*^9}, {3.76288268166161*^9, 
   3.7628828236602783`*^9}, {3.763196071422804*^9, 3.763196072829831*^9}, {
   3.7631962218942337`*^9, 3.763196223473593*^9}, {3.7631962878661537`*^9, 
   3.7631963981101513`*^9}, {3.7631968322744102`*^9, 3.763196898446464*^9}, {
   3.7631969350034895`*^9, 3.7631969657126923`*^9}, {3.7637353747163663`*^9, 
   3.7637353973789845`*^9}, {3.7637363340316205`*^9, 3.763736613995328*^9}, {
   3.7637366660687876`*^9, 3.7637368128973193`*^9}, {3.76373688677866*^9, 
   3.76373703404508*^9}, {3.7637370800715036`*^9, 3.7637371409029293`*^9}, {
   3.7637372652049503`*^9, 3.763737273893346*^9}, {3.763737802096672*^9, 
   3.7637378255334997`*^9}, {3.763737958437546*^9, 3.7637379591288977`*^9}, {
   3.7637380636055756`*^9, 3.763738166727786*^9}, {3.763739543807525*^9, 
   3.763739548323162*^9}, {3.76373958043946*^9, 3.7637396308625603`*^9}, {
   3.7637396872036576`*^9, 3.7637397163623505`*^9}, {3.763739746674115*^9, 
   3.7637397721320734`*^9}, {3.7637398143818865`*^9, 3.763739840127501*^9}, {
   3.7637398952409253`*^9, 3.7637399379591036`*^9}, {3.7637400429414167`*^9, 
   3.7637400617076283`*^9}, {3.7637400938973465`*^9, 
   3.7637401102701597`*^9}, {3.763740146638019*^9, 3.7637401765694265`*^9}, {
   3.763740622387603*^9, 3.7637406305531187`*^9}, {3.7637406836475873`*^9, 
   3.7637407775053577`*^9}, {3.763740967852112*^9, 3.7637409890545144`*^9}, {
   3.7637412638188753`*^9, 3.763741266171664*^9}, {3.76374140804543*^9, 
   3.763741411971968*^9}, {3.763741446167456*^9, 3.7637414501067996`*^9}, {
   3.763741821203325*^9, 3.7637418595470266`*^9}, {3.763741926819002*^9, 
   3.7637419269088783`*^9}, {3.763743754687969*^9, 3.763743765916583*^9}, {
   3.765348073865455*^9, 3.765348178169607*^9}, {3.7653482362871885`*^9, 
   3.7653483033750324`*^9}, {3.765348418675788*^9, 3.7653485318429427`*^9}, 
   3.765348574406087*^9, {3.765348650204297*^9, 3.7653486556424294`*^9}, {
   3.765348758627488*^9, 3.7653487674632072`*^9}, {3.765348805459452*^9, 
   3.765348840930339*^9}, {3.765348968069233*^9, 3.765348968274682*^9}, {
   3.7653490463131895`*^9, 3.7653490766825066`*^9}, {3.765349364562896*^9, 
   3.7653494396940346`*^9}, {3.76535004110809*^9, 3.7653500502149734`*^9}, {
   3.765350080566573*^9, 3.7653500945309815`*^9}, {3.7653504567079215`*^9, 
   3.7653505118113174`*^9}, {3.7653506678761764`*^9, 
   3.7653506709944277`*^9}, {3.765350869121233*^9, 3.765350883379421*^9}, {
   3.7787539679228287`*^9, 3.7787539939970565`*^9}, {3.778754041222766*^9, 
   3.7787540429671*^9}, {3.77875411774466*^9, 3.778754154761667*^9}, {
   3.778754187190982*^9, 3.778754263003207*^9}, {3.7787598489353795`*^9, 
   3.7787598637896585`*^9}, 3.7787598956635685`*^9, 3.778759927398739*^9, {
   3.778760029956932*^9, 3.7787600588311496`*^9}, {3.7787601357520037`*^9, 
   3.778760158721545*^9}, {3.7787606087753363`*^9, 3.778760684075082*^9}, {
   3.7787607243851633`*^9, 3.7787607263830366`*^9}, {3.7787607744087734`*^9, 
   3.7787608286708736`*^9}, {3.778760861115976*^9, 3.7787608656642437`*^9}, {
   3.7787608963818617`*^9, 3.778760949376485*^9}, {3.778760987298323*^9, 
   3.778761024244014*^9}, {3.7787610667475963`*^9, 3.7787611102192917`*^9}, {
   3.7787611475654793`*^9, 3.778761181861247*^9}, {3.7787612324661837`*^9, 
   3.778761248287563*^9}, {3.7787612843382607`*^9, 3.7787613234404593`*^9}, {
   3.7787613680391426`*^9, 3.778761386185852*^9}, {3.7787614512468624`*^9, 
   3.778761537737152*^9}, 3.778761683708655*^9, {3.7787617480374737`*^9, 
   3.778761762622002*^9}, {3.7787619420773067`*^9, 3.7787620589447956`*^9}, {
   3.778762236546506*^9, 3.778762382989579*^9}, 3.778762452092203*^9, {
   3.778762489608778*^9, 3.7787626251541605`*^9}, {3.7787627775180364`*^9, 
   3.7787627957542095`*^9}, 3.778846579575522*^9, {3.778846612493493*^9, 
   3.7788466967954483`*^9}, {3.778846754521078*^9, 3.778846769782303*^9}, {
   3.778846807374733*^9, 3.7788468982207904`*^9}, {3.7788471001418514`*^9, 
   3.7788471448682013`*^9}, {3.7798725198786173`*^9, 3.779872520154916*^9}, {
   3.7798725511101365`*^9, 3.7798725877282095`*^9}, {3.779872936066137*^9, 
   3.7798729674522057`*^9}, {3.779873062037302*^9, 3.7798732226597223`*^9}, {
   3.779873308639051*^9, 3.779873316319553*^9}, {3.7798734230401597`*^9, 
   3.7798734698768644`*^9}, {3.7798735442629795`*^9, 
   3.7798736158584795`*^9}, {3.7798738062144623`*^9, 3.779873807134*^9}, {
   3.7798739801746063`*^9, 3.7798739928407345`*^9}, {3.7798742228718243`*^9, 
   3.779874288080402*^9}, {3.779874337328699*^9, 3.77987447994488*^9}, {
   3.779874510992853*^9, 3.779874519058282*^9}, {3.779874553969923*^9, 
   3.779874575020626*^9}, {3.77987463228265*^9, 3.7798747176483703`*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"027013a8-cec3-4835-a3c6-868636f58f47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<file.jpg\>\"", ",", "speed", ",", "\"\<JPG\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.765350661385248*^9, 3.7653506804733286`*^9}, {
  3.7653507482131095`*^9, 
  3.765350757512478*^9}},ExpressionUUID->"2f674ba4-a39e-48a8-90ea-\
7e609217935c"]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 36695, 791, 989, "Input", "ExpressionUUID" -> \
"027013a8-cec3-4835-a3c6-868636f58f47"],
Cell[37256, 813, 322, 8, 47, "Input", "ExpressionUUID" -> \
"2f674ba4-a39e-48a8-90ea-7e609217935c"]
}
]
*)

